
<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## RFDataHub

> A presente biblioteca tem como intuito agregar dados de esta√ß√µes
> transmissoras de Radiofrequ√™ncia

- O fluxo √© concentrado nos dados licenciados junto √† ANATEL de servi√ßos
  p√∫blicos de Radiodifus√£o e Servi√ßos Privados de Telecomunica√ß√µes, al√©m
  de dados de emissores aeron√°uticos consumidos de diversas APIs e
  fontes documentais institucionais.

- Os diversos m√≥dulos presentes fazem a extra√ß√£o, limpeza,
  p√≥s-processamento, valida√ß√£o, verifica√ß√£o de qualidade e agrega√ß√£o
  desses dados num formato consolidado para os planos de monitora√ß√£o da
  ANATEL.

## BASES DE DADOS

> A Seguir s√£o descritas as inst√¢ncias de banco, as bases de dados e as
> tabelas consultadas.

- Inst√¢ncia de Banco de Dados SQL - Server - `ANATELBDRO05`:
  - Base de Dados: `SITARWEB`:
    - `STEL` - Servi√ßos Privados de Telecomunica√ß√µes  
      Base legada cujos registros, novos e antigos, est√£o sendo
      transferidos para o banco de dados `licenciamento` da inst√¢ncia
      `ANATELBDRO06`
  - Base de Dados: `SRD`:
    - `RADCOM` - Servi√ßo de Radiodifus√£o Comunit√°ria
- Inst√¢ncia de Banco de Dados MongoDB - `ANATELBDRO06`:
  - Base de Dados: `sms`
    - Cole√ß√£o: `srd`:
      - `SRD` - Demais servi√ßos de Radiodifus√£o, e.g.¬†TV, RTV, RTVD, FM,
        AM, etc.
    - Cole√ß√£o: `licenciamento`:
      - `TELECOM` - Servi√ßos Privados de Telecomunica√ß√µes, e.g.¬†Limitado
        Privado.
      - `SMP` - Servi√ßo M√≥vel Pessoal, e.g.¬†4G e 5G

  > A base de dados `sms`, e no geral a inst√¢ncia como um todo, √©
  > referida como `MOSAICO` por conta da plataforma web no qual s√£o
  > servidos esses dados para acesso.
- `AERONAUTICA` - Consolida√ß√£o de diversas bases de dados p√∫blicas da
  aeron√°utica. Esses dados s√£o enriquecidos com informa√ß√µes adicionais
  fornecidas por √≥rg√£os como o DECEA, al√©m de emiss√µes conhecidas
  provenientes de conhecimento t√©cnico pr√©vio consolidado na ag√™ncia.

## RADCOM

<details>
<summary>Code</summary>

``` python
pasta = Path.cwd().parent / 'dados'
df = pd.read_parquet(pasta / 'radcom.parquet.gzip')
df.sample(5).iloc[:, :6]
```

</details>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequ√™ncia</th>
      <th>Entidade</th>
      <th>Fistel</th>
      <th>Esta√ß√£o</th>
      <th>Munic√≠pio</th>
      <th>C√≥digo_Munic√≠pio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3168</th>
      <td>104.9</td>
      <td>ASSOCIACAO COMUNITARIA JOAIMENSE CULTURAL DE R...</td>
      <td>50012640301</td>
      <td>682812145</td>
      <td>Joa√≠ma</td>
      <td>3136009</td>
    </tr>
    <tr>
      <th>3345</th>
      <td>104.9</td>
      <td>ASSOCIACAO DE AMIGOS VALE DO GUAPORE</td>
      <td>50013713175</td>
      <td>683836722</td>
      <td>Pontes e Lacerda</td>
      <td>5106752</td>
    </tr>
    <tr>
      <th>4433</th>
      <td>105.9</td>
      <td>ASSOCIACAO COMUNITARIA DE APOIO A CIDADANIA-ACAC</td>
      <td>50013423096</td>
      <td>683549529</td>
      <td>Guarar√°</td>
      <td>3128501</td>
    </tr>
    <tr>
      <th>3169</th>
      <td>104.9</td>
      <td>ASSOCIA√á√ÉO COMUNIT√ÅRIA EDUCATIVA DE JURAMENTO ...</td>
      <td>50409156329</td>
      <td>699282721</td>
      <td>Juramento</td>
      <td>3136801</td>
    </tr>
    <tr>
      <th>457</th>
      <td>87.9</td>
      <td>ASSOCIA√á√ÉO COMUNIT√ÅRIA E DE COMUNICA√á√ÉO SOCIAL...</td>
      <td>50409272230</td>
      <td>697612040</td>
      <td>Salitre</td>
      <td>2311959</td>
    </tr>
  </tbody>
</table>
</div>

### Filtragem ‚úÇÔ∏è

Os √∫nicos filtros efetuados na *query* para os dados de RADCOM s√£o:

``` sql
<...>
where
    SRD.IdtPlanoBasico is not Null 
    and SRD.IndFase is not Null
<...>
```

Esse filtro significa que a emiss√£o est√° licenciada devidamente com o
processo de outorga j√° conclu√≠do ou com funcionamento autorizado.

<details>
<summary>Code</summary>

``` python
print(f'A base RADCOM possui atualmente {len(df)} registros ativos.')
```

</details>

    A base RADCOM possui atualmente 4996 registros ativos.

### Descri√ß√£o üìä

A seguir s√£o descritas as colunas extra√≠das da base e o significado de
cada uma

- `Frequ√™ncia`: Frequ√™ncia de Transmiss√£o da Esta√ß√£o
- `Entidade`: Nome da Pessoa (F√≠sica \| Jur√≠dica) detentora da Outorga
- `Fistel`: C√≥digo itentificador da Outorga de Servi√ßo, um Fistel pode
  conter uma ou mais esta√ß√µes
- `Esta√ß√£o`: C√≥digo Identificador da Esta√ß√£o - C√≥digo n√£o
  necess√°riamente √∫nico, por vezes uma √∫nica esta√ß√£o possui diversos
  transmissores com caracter√≠sticas distintas
- `Munic√≠pio`: Munic√≠pio de Outorga daquela esta√ß√£o
- `C√≥digo_Munic√≠pio`: C√≥digo √∫nico do IBGE identificando univocamente o
  munic√≠pio, esse c√≥digo √© utilizado para validar a localiza√ß√£o das
  coordenadas da esta√ß√£o
- `UF`: Unidade Federativa ( Estado )
- `Latitude`: Latitude em formato Decimal
- `Longitude`: Longitude em formato Decimal
- `Fase`: Fase do Processo de Licenciamento
- `Situa√ß√£o`: Situa√ß√£o da Outorga

### P√≥s-Processamento üõ†Ô∏è

A seguir s√£o descritas as colunas adicionadas √† base extra√≠da e o
significado de cada uma

> As colunas `Fase` e `Situa√ß√£o` somente existem na base `RADCOM`, para
> normalizar esses dados e combinar com as demais bases, essas duas
> colunas s√£o transformadas em uma √∫nica coluna chamada `Classe`, essa
> coluna tem o intuito em todas as tabelas de identificar o tipo de
> esta√ß√£o transmissora:

- Onde a informa√ß√£o de `Situa√ß√£o` √© ausente, a `Classe` √© igual a
  `Fase`, exemplos:
  - `3`
  - `P`
- Onde ambas est√£o presentes a `Classe` √© igual a `<Fase>-<Situa√ß√£o>`:
  - `3-P`
  - `P-A`
- `Servi√ßo`: N√∫mero identificador do servi√ßo, no caso de `RADCOM` o
  valor √© √∫nico: `231`
- `Classe_Emiss√£o`: Dado ausente na base de `RADCOM` , inserido valores
  √∫nicos nulos para normalizar com as demais bases
- `Largura_Emiss√£o(kHz)`: Largura de Banda da Emiss√£o em kHz. Nessa
  coluna √© imputado o valor de `256`, valor padr√£o para o servi√ßo FM.
- `Validade_RF`: Dado ausente na base de `RADCOM` , inserido valores
  √∫nicos nulos para normalizar com as demais bases
- `Status`: Dado ausente na base de `RADCOM` , inserido valor √∫nico
  `RADCOM` para normalizar com demais bases
- `Fonte`: Fonte dos dados, nessa caso √© inserido o nome da Tabela:
  `SRD`
- `Multiplicidade`: Contagem do Registro. Nesse caso o valor √© somente
  `1` por conta de todos os registros serem √∫nicos, i.e.¬†s√£o referentes
  a uma esta√ß√£o √∫nica

### Dados Incorretos üóëÔ∏è

A seguir s√£o exibidas informa√ß√µes sobre coordenadas ausentes ou
facilmente identificadas como incorretas, nesse caso fora dos limites do
Brasil. \> Uma valida√ß√£o precisa das coordenadas √© feita antes de
consolidar o arquivo final e ser√° descrita posteriormente

<details>
<summary>Code</summary>

``` python
print(f'N√∫mero de coordenadas ausentes: {df[df.Latitude.isna() | df.Longitude.isna()].shape[0]}')
```

</details>

    N√∫mero de coordenadas ausentes: 0

<details>
<summary>Code</summary>

``` python
df[['Latitude', 'Longitude']] = df[['Latitude', 'Longitude']].astype('float')
bad = df[~(df.Latitude.between(MIN_LAT, MAX_LAT) & df.Longitude.between(MIN_LONG, MAX_LONG))]
print("Exemplo de coordenadas incorretas, fora dos limites do Brasil: ")
bad.loc[:, ['Frequ√™ncia', 'Entidade', 'Esta√ß√£o', 'Munic√≠pio', 'Latitude', 'Longitude']]
```

</details>

    Exemplo de coordenadas incorretas, fora dos limites do Brasil: 

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequ√™ncia</th>
      <th>Entidade</th>
      <th>Esta√ß√£o</th>
      <th>Munic√≠pio</th>
      <th>Latitude</th>
      <th>Longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>64</th>
      <td>87.5</td>
      <td>ASSOCIA√á√ÉO SERRANA COMUNIT√ÅRIA - ASERCOM</td>
      <td>691861544</td>
      <td>S√£o Francisco de Paula</td>
      <td>-50.572500</td>
      <td>-29.446389</td>
    </tr>
    <tr>
      <th>327</th>
      <td>87.9</td>
      <td>Associa√ß√£o de Radiodifus√£o Comunit√°ria de Ipec...</td>
      <td>1010974570</td>
      <td>Ipecaet√°</td>
      <td>-0.205286</td>
      <td>-0.655050</td>
    </tr>
    <tr>
      <th>470</th>
      <td>87.9</td>
      <td>ASSOCIA√á√ÉO COMUNIT√ÅRIA E CULTURAL DE BOA ESPER...</td>
      <td>695516850</td>
      <td>Boa Esperan√ßa</td>
      <td>-36.535556</td>
      <td>-79.833889</td>
    </tr>
    <tr>
      <th>482</th>
      <td>87.9</td>
      <td>Associa√ß√£o Rural Jaguarense</td>
      <td>1015029458</td>
      <td>Jaguar√©</td>
      <td>-0.313650</td>
      <td>-0.669211</td>
    </tr>
    <tr>
      <th>638</th>
      <td>87.9</td>
      <td>ASSOCIA√á√ÉO COMUNIT√ÅRIA DE S√ÉO LUIZ DO NORTE</td>
      <td>695284665</td>
      <td>S√£o Luiz do Norte</td>
      <td>-36.042222</td>
      <td>-68.627222</td>
    </tr>
    <tr>
      <th>736</th>
      <td>87.9</td>
      <td>ASSOCIA√á√ÉO COMUNIT√ÅRIA VOZ DE S√ÉO PEDRO DOS CR...</td>
      <td>691975078</td>
      <td>S√£o Pedro dos Crentes</td>
      <td>-3.501111</td>
      <td>-0.773333</td>
    </tr>
    <tr>
      <th>1072</th>
      <td>87.9</td>
      <td>ASSOCIA√á√ÉO DOS AMIGOS DA CULTURA</td>
      <td>691081085</td>
      <td>Po√ßos de Caldas</td>
      <td>-45.838889</td>
      <td>-21.923611</td>
    </tr>
    <tr>
      <th>1267</th>
      <td>87.9</td>
      <td>ASSOCIA√á√ÉO COMUNIT√ÅRIA IPIRANGUENSE</td>
      <td>1014626029</td>
      <td>Ipiranga do Norte</td>
      <td>-0.203989</td>
      <td>-0.935672</td>
    </tr>
    <tr>
      <th>1330</th>
      <td>87.9</td>
      <td>FUNDA√á√ÉO DE ASSIST√äNCIA √Ä FAM√çLIA ANT√îNIO CORR...</td>
      <td>695446541</td>
      <td>Irituia</td>
      <td>-1.771389</td>
      <td>-4.437222</td>
    </tr>
    <tr>
      <th>1406</th>
      <td>87.9</td>
      <td>CENTRO INTEGRADO DE A√á√ïES COMUNIT√ÅRIAS PELA VIDA</td>
      <td>1015253617</td>
      <td>Jo√£o Pessoa</td>
      <td>-0.119872</td>
      <td>-0.580836</td>
    </tr>
    <tr>
      <th>1703</th>
      <td>87.9</td>
      <td>Associa√ß√£o Comunit√°ria de Tamoios</td>
      <td>1014984820</td>
      <td>Cabo Frio</td>
      <td>-0.376531</td>
      <td>-0.700028</td>
    </tr>
    <tr>
      <th>2103</th>
      <td>87.9</td>
      <td>ASSOCIA√á√ÉO DE M√çDIA COMUNIT√ÅRIA DA CIDADE DE N...</td>
      <td>1009018300</td>
      <td>Nhandeara</td>
      <td>-20.694167</td>
      <td>-5.041111</td>
    </tr>
    <tr>
      <th>2384</th>
      <td>98.5</td>
      <td>ASSOCIA√á√ÉO DE R√ÅDIO E CULTURA</td>
      <td>691860033</td>
      <td>Serra</td>
      <td>-52.223611</td>
      <td>-40.211389</td>
    </tr>
    <tr>
      <th>2441</th>
      <td>98.7</td>
      <td>INSTITUTO DE RADIODIFUS√ÉO E DESENVOLVIMENTO CO...</td>
      <td>1014997094</td>
      <td>Sobral</td>
      <td>-0.067903</td>
      <td>-0.665706</td>
    </tr>
    <tr>
      <th>2442</th>
      <td>98.7</td>
      <td>Centro Cultural de Comunica√ß√£o de Jaibaras - CCCJ</td>
      <td>1014529902</td>
      <td>Sobral</td>
      <td>-0.062869</td>
      <td>-0.674886</td>
    </tr>
    <tr>
      <th>2619</th>
      <td>104.9</td>
      <td>ASSOCIA√á√ÉO SEMEANDO PARA O FUTURO</td>
      <td>1014898444</td>
      <td>Belmonte</td>
      <td>-0.264261</td>
      <td>-0.647931</td>
    </tr>
    <tr>
      <th>2934</th>
      <td>104.9</td>
      <td>ASSOCIA√á√ÉO DE RADIODIFUS√ÉO COMUNIT√ÅRIA DE NENE...</td>
      <td>1015020108</td>
      <td>Quixeramobim</td>
      <td>5.441389</td>
      <td>-39.197500</td>
    </tr>
    <tr>
      <th>3145</th>
      <td>104.9</td>
      <td>ASSOCIA√á√ÉO COMUNIT√ÅRIA AMIGOS DE GUIDOVAL</td>
      <td>1015168172</td>
      <td>Guidoval</td>
      <td>-0.352519</td>
      <td>-0.713217</td>
    </tr>
    <tr>
      <th>3329</th>
      <td>104.9</td>
      <td>ASSOCIA√á√ÉO COMUNIT√ÅRIA E CULTURAL DE CONQUISTA...</td>
      <td>699394678</td>
      <td>Conquista D'Oeste</td>
      <td>-14.537222</td>
      <td>-29.546944</td>
    </tr>
    <tr>
      <th>3421</th>
      <td>104.9</td>
      <td>ASSOCIA√á√ÉO DE RADIODIFUS√ÉO COMUNIT√ÅRIA CAMPOS ...</td>
      <td>1014527870</td>
      <td>Tracuateua</td>
      <td>-0.017892</td>
      <td>-0.781681</td>
    </tr>
    <tr>
      <th>4785</th>
      <td>105.9</td>
      <td>ASSOCIA√á√ÉO DE DESENVOLVIMENTO CULTURAL, ART√çST...</td>
      <td>692127186</td>
      <td>Suzan√°polis</td>
      <td>-20.500833</td>
      <td>-1.024444</td>
    </tr>
    <tr>
      <th>4878</th>
      <td>106.3</td>
      <td>Associa√ß√£o Comunit√°ria de Desenvolvimento Art√≠...</td>
      <td>1014529481</td>
      <td>Campo Grande</td>
      <td>-0.340136</td>
      <td>-0.909458</td>
    </tr>
  </tbody>
</table>
</div>

## STEL

<details>
<summary>Code</summary>

``` python
df = pd.read_parquet(pasta / 'stel.parquet.gzip')
df[['Latitude', 'Longitude']] = df[['Latitude', 'Longitude']].astype('float')
df.sample(5).iloc[:, :6]
```

</details>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequ√™ncia</th>
      <th>Entidade</th>
      <th>Fistel</th>
      <th>Esta√ß√£o</th>
      <th>Munic√≠pio</th>
      <th>C√≥digo_Munic√≠pio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>16415</th>
      <td>156.675</td>
      <td>PETROLEO BRASILEIRO S A PETROBRAS</td>
      <td>50411168908</td>
      <td>1008756757</td>
      <td>Santos</td>
      <td>3548500</td>
    </tr>
    <tr>
      <th>25728</th>
      <td>945.0</td>
      <td>UNIVERSIDADE FEDERAL DO PARA</td>
      <td>50416059716</td>
      <td>1006864110</td>
      <td>Acar√°</td>
      <td>1500206</td>
    </tr>
    <tr>
      <th>21282</th>
      <td>450.4875</td>
      <td>RADIO DIFUSORA COLMEIA DE PORTO UNIAO LTDA ME</td>
      <td>14020348812</td>
      <td>1002823339</td>
      <td>Uni√£o da Vit√≥ria</td>
      <td>4128203</td>
    </tr>
    <tr>
      <th>7963</th>
      <td>156.5</td>
      <td>HDG SERVICOS AMBIENTAIS LTDA</td>
      <td>50405428871</td>
      <td>1008115409</td>
      <td>S√£o Francisco do Conde</td>
      <td>2929206</td>
    </tr>
    <tr>
      <th>24272</th>
      <td>902.6</td>
      <td>UNIVERSIDADE FEDERAL DO PARA</td>
      <td>50412323184</td>
      <td>1001729843</td>
      <td>Bel√©m</td>
      <td>1501402</td>
    </tr>
  </tbody>
</table>
</div>

### Filtragem ‚úÇÔ∏è

> A base do `STEL` de esta√ß√µes outorgadas ativas originalmente era muito
> grande, comportando milh√µes de registros, gradualmente os registros
> ativos e novos registros foram migrados para a base `licenciamento` do
> `MOSAICO`

A seguir s√£o descritos os filtros realizados na *query* do `STEL`:

``` sql
  <...>
where
  HABILITACAO.NumServico <> '010' #1 
  and ESTACAO.DataExclusao is null #2
  and ESTACAO.IndStatusEstacao = 'L' #3
  and Municipio.CodMunicipio is not null #4
  and frequencia.MedTransmissaoInicial is not null #5 
  and frequencia.CodStatusRegistro = 'L' #6
  and contrato.DataValidadeRadiofrequencia is not null #7
```

Explicando a query acima linha a linha:

1.  Excluir esta√ß√µes do Servi√ßo M√≥vel Pessoal (SMP - 010)
2.  Incluir somente esta√ß√µes com `Data de Exclus√£o` nula, i.e.¬†esta√ß√µes
    ativas
3.  Incluir somente esta√ß√µes com estado `L` (LICENCIADO)
4.  Excluir esta√ß√µes com o c√≥digo do munic√≠pio ausente (Necess√°rio para
    validar a localiza√ß√£o)
5.  Excluir esta√ß√µes sem a frequ√™ncia de transmiss√£o atribu√≠da
6.  Excluir esta√ß√µes cuja frequ√™ncia atribu√≠da esteja distinta do estado
    `L` ( LICENCIADO )
7.  Excluir esta√ß√µes cuja Validade de Radiofrequ√™ncia esteja nula

<details>
<summary>Code</summary>

``` python
print(f'A base STEL possui atualmente {len(df)} registros ativos pelos filtros descritos.')
```

</details>

    A base STEL possui atualmente 35417 registros ativos pelos filtros descritos.

### Descri√ß√£o üìä

Abaixo s√£o descritas as colunas que n√£o foram descritas anteriormente na
base de `RADCOM`

- `Classe`: String que identifica o tipo de esta√ß√£o , e.g
  `Fixa Aeron√°utica`, `Fixa Base`, `M√≥vel`, `Transmissora` etc‚Ä¶
- `Servi√ßo`: C√≥digo que identifica o Servi√ßo Outorgado na Anatel,
  aqui existem diversos servi√ßos: `604, 035, 507, 019`
- `Validade_RF`: Data de Validade da Radiofrequ√™ncia

As demais colunas foram descritas anteriormente para a base `RADCOM`

### P√≥s-Processamento üõ†Ô∏è

> Nas tabelas do banco de dados do STEL, na modelagem de banco as
> informa√ß√µes de `Classe_Emiss√£o` e `Largura_Emiss√£o` foram codificadas
> numa √∫nica string chamada `Designa√ß√£o de Emiss√£o`, √© efetuado o
> processamento dessa string para resgatar as informa√ß√µes individuais em
> 2 colunas:

- `Classe_Emiss√£o`: C√≥digo que identifica as caracter√≠stica da emiss√£o
  daquela esta√ß√£o
- `Largura_Emiss√£o(kHz)`: Largura de Emiss√£o em kHz
- A coluna `Validade_RF` √© filtrada para constar somente a data, ela
  aparece no formato `datetime` nas tabelas do banco, no entanto com
  informa√ß√£o de hora nula
- A `Frequ√™ncia` √© normalizada para a unidade `MHz`
- `Status`: Essa coluna √© criada para normalizar as colunas das bases do
  `MOSAICO`. √â inserido um valor √∫nico `L`
- `Fonte`: Fonte dos dados, nessa caso √© inserido o nome do Banco `STEL`
- `Multiplicidade`: Contagem do Registro. Nesse caso o valor √© somente
  `1` por conta de todos os registros serem √∫nicos, i.e.¬†s√£o referentes
  a uma esta√ß√£o √∫nica

### Dados Incorretos üóëÔ∏è

A seguir s√£o exibidas informa√ß√µes sobre coordenadas ausentes ou
facilmente identificadas como incorretas, nesse caso fora dos limites do
Brasil.

> Uma valida√ß√£o precisa das coordenadas √© feita antes de consolidar o
> arquivo final e ser√° descrita posteriormente

<details>
<summary>Code</summary>

``` python
print(f'N√∫mero de coordenadas ausentes: {df[df.Latitude.isna() | df.Longitude.isna()].shape[0]}')
```

</details>

    N√∫mero de coordenadas ausentes: 0

<details>
<summary>Code</summary>

``` python
df[['Latitude', 'Longitude']] = df[['Latitude', 'Longitude']].astype('float')
bad = df[~(df.Latitude.between(MIN_LAT, MAX_LAT) & df.Longitude.between(MIN_LONG, MAX_LONG))]
print("Exemplo de coordenadas incorretas, fora dos limites do Brasil: ")
bad.loc[:, ['Frequ√™ncia', 'Entidade', 'Esta√ß√£o', 'Munic√≠pio', 'Latitude', 'Longitude']]
```

</details>

    Exemplo de coordenadas incorretas, fora dos limites do Brasil: 

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequ√™ncia</th>
      <th>Entidade</th>
      <th>Esta√ß√£o</th>
      <th>Munic√≠pio</th>
      <th>Latitude</th>
      <th>Longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1985</th>
      <td>131.875</td>
      <td>AZUL LINHAS AEREAS BRASILEIRAS S.A</td>
      <td>1009302628</td>
      <td>Porto Seguro</td>
      <td>-16.440833</td>
      <td>-30.081389</td>
    </tr>
    <tr>
      <th>2874</th>
      <td>153.57</td>
      <td>RADIO SAO CARLOS LTDA.ME</td>
      <td>3570061</td>
      <td>S√£o Carlos</td>
      <td>-21.033333</td>
      <td>-27.966667</td>
    </tr>
    <tr>
      <th>2966</th>
      <td>153.57</td>
      <td>RADIO SAO CARLOS LTDA.ME</td>
      <td>3570070</td>
      <td>S√£o Carlos</td>
      <td>-22.033333</td>
      <td>-27.966667</td>
    </tr>
    <tr>
      <th>9239</th>
      <td>156.525</td>
      <td>LOC PILOT PRATICAGEM - EIRELI</td>
      <td>1008355728</td>
      <td>S√£o Sebasti√£o</td>
      <td>-45.467519</td>
      <td>-23.817844</td>
    </tr>
    <tr>
      <th>9956</th>
      <td>156.525</td>
      <td>LOC PILOT PRATICAGEM - EIRELI</td>
      <td>1008355710</td>
      <td>Santos</td>
      <td>-46.297125</td>
      <td>-23.986986</td>
    </tr>
    <tr>
      <th>10487</th>
      <td>156.525</td>
      <td>LOC PILOT PRATICAGEM - EIRELI</td>
      <td>1008355728</td>
      <td>S√£o Sebasti√£o</td>
      <td>-45.467519</td>
      <td>-23.817844</td>
    </tr>
    <tr>
      <th>12559</th>
      <td>156.5</td>
      <td>AMBIPAR RESPONSE S/A</td>
      <td>1010754715</td>
      <td>Guamar√©</td>
      <td>-36.390586</td>
      <td>-5.148578</td>
    </tr>
    <tr>
      <th>13924</th>
      <td>156.65</td>
      <td>AMBIPAR RESPONSE S/A</td>
      <td>1010754715</td>
      <td>Guamar√©</td>
      <td>-36.390586</td>
      <td>-5.148578</td>
    </tr>
    <tr>
      <th>14702</th>
      <td>156.525</td>
      <td>LOC PILOT PRATICAGEM - EIRELI</td>
      <td>1008355710</td>
      <td>Santos</td>
      <td>-46.297125</td>
      <td>-23.986986</td>
    </tr>
    <tr>
      <th>18343</th>
      <td>156.8</td>
      <td>AMBIPAR RESPONSE S/A</td>
      <td>1010754715</td>
      <td>Guamar√©</td>
      <td>-36.390586</td>
      <td>-5.148578</td>
    </tr>
    <tr>
      <th>30239</th>
      <td>25.375</td>
      <td>ENERGIA SUSTENTAVEL DO BRASIL S.A.</td>
      <td>699898102</td>
      <td>Porto Velho</td>
      <td>9.269350</td>
      <td>-64.642775</td>
    </tr>
    <tr>
      <th>30247</th>
      <td>25.375</td>
      <td>ENERGIA SUSTENTAVEL DO BRASIL S.A.</td>
      <td>699898080</td>
      <td>Porto Velho</td>
      <td>9.270789</td>
      <td>-64.640611</td>
    </tr>
    <tr>
      <th>30248</th>
      <td>25.375</td>
      <td>ENERGIA SUSTENTAVEL DO BRASIL S.A.</td>
      <td>699898161</td>
      <td>Porto Velho</td>
      <td>9.245614</td>
      <td>-64.646772</td>
    </tr>
    <tr>
      <th>30249</th>
      <td>25.375</td>
      <td>ENERGIA SUSTENTAVEL DO BRASIL S.A.</td>
      <td>699898188</td>
      <td>Porto Velho</td>
      <td>9.247097</td>
      <td>-64.646789</td>
    </tr>
    <tr>
      <th>31146</th>
      <td>25.375</td>
      <td>ENERGIA SUSTENTAVEL DO BRASIL S.A.</td>
      <td>699898161</td>
      <td>Porto Velho</td>
      <td>9.245614</td>
      <td>-64.646772</td>
    </tr>
    <tr>
      <th>31147</th>
      <td>25.375</td>
      <td>ENERGIA SUSTENTAVEL DO BRASIL S.A.</td>
      <td>699898188</td>
      <td>Porto Velho</td>
      <td>9.247097</td>
      <td>-64.646789</td>
    </tr>
    <tr>
      <th>31158</th>
      <td>25.375</td>
      <td>ENERGIA SUSTENTAVEL DO BRASIL S.A.</td>
      <td>699898102</td>
      <td>Porto Velho</td>
      <td>9.269350</td>
      <td>-64.642775</td>
    </tr>
    <tr>
      <th>31655</th>
      <td>25.375</td>
      <td>ENERGIA SUSTENTAVEL DO BRASIL S.A.</td>
      <td>699898080</td>
      <td>Porto Velho</td>
      <td>9.270789</td>
      <td>-64.640611</td>
    </tr>
    <tr>
      <th>31663</th>
      <td>25.375</td>
      <td>ENERGIA SUSTENTAVEL DO BRASIL S.A.</td>
      <td>699898137</td>
      <td>Porto Velho</td>
      <td>9.248617</td>
      <td>-64.646650</td>
    </tr>
    <tr>
      <th>34111</th>
      <td>950.125</td>
      <td>RADIO TERRA NOVA FM LTDA</td>
      <td>1005552212</td>
      <td>Terra Nova</td>
      <td>-38.618911</td>
      <td>-12.405617</td>
    </tr>
    <tr>
      <th>35367</th>
      <td>25.375</td>
      <td>ENERGIA SUSTENTAVEL DO BRASIL S.A.</td>
      <td>699898137</td>
      <td>Porto Velho</td>
      <td>9.248617</td>
      <td>-64.646650</td>
    </tr>
  </tbody>
</table>
</div>

## MOSAICO - Radiodifus√£o

<details>
<summary>Code</summary>

``` python
df = pd.read_parquet(pasta / 'srd.parquet.gzip')
df[['Latitude', 'Longitude']] = df[['Latitude', 'Longitude']].astype('float')
df.sample(5).iloc[:, :6]
```

</details>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequ√™ncia</th>
      <th>Entidade</th>
      <th>Fistel</th>
      <th>Esta√ß√£o</th>
      <th>Munic√≠pio</th>
      <th>C√≥digo_Munic√≠pio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6157</th>
      <td>85.0</td>
      <td>PREFEITURA MUNICIPAL DE SEARA</td>
      <td>50400688832</td>
      <td>323090346</td>
      <td>Seara</td>
      <td>4217501</td>
    </tr>
    <tr>
      <th>23822</th>
      <td>593.0</td>
      <td>SOCIEDADE RADIO E TELEVISAO ALTEROSA S. A.</td>
      <td>50441109144</td>
      <td>1013206573</td>
      <td>Pitangui</td>
      <td>3151404</td>
    </tr>
    <tr>
      <th>1588</th>
      <td>85.0</td>
      <td>PREFEITURA MUNICIPAL DE NOVA VENECIA</td>
      <td>50400133296</td>
      <td>5591031</td>
      <td>Nova Ven√©cia</td>
      <td>3203908</td>
    </tr>
    <tr>
      <th>16758</th>
      <td>97.3</td>
      <td>VALE COMUNICA√á√ïES LTDA</td>
      <td>50401377539</td>
      <td>688751997</td>
      <td>Diamantino</td>
      <td>5103502</td>
    </tr>
    <tr>
      <th>8657</th>
      <td>479.0</td>
      <td>RADIO E TELEVISAO BANDEIRANTES LTDA</td>
      <td>50416827802</td>
      <td>1007852310</td>
      <td>√Åguas de Lind√≥ia</td>
      <td>3500501</td>
    </tr>
  </tbody>
</table>
</div>

### Filtragem ‚úÇÔ∏è

Os filtros efetuados diretamente no banco MongoDB do Mosaico s√£o
simples, a *query* completa ocupa somente 3 linhas:

``` python
{
"frequency": {"$nin": [None, "", 0], "$type": 1.0},
"srd_planobasico.CodMunicipio": {"$nin": [None, ""]},
"NumFistel": {"$nin": [None, ""]},
}
```

- Excluir frequ√™ncias nulas ou zeradas, e excluir registros n√£o
  num√©ricos (`"$type": 1.0` )
- Excluir registros com c√≥digo de munic√≠pio ausente ou inv√°lido (
  Necess√°rio para validar as coordenadas)
- Excluir registros com n√∫mero do Fistel Nulo ou Inv√°lido

### Descri√ß√£o üìä

> ü§å N√£o existem informa√ß√µes no MOSAICO de `Classe_Emiss√£o` e tampouco
> `Largura_de_Emiss√£o` para o servi√ßo de Radiodifus√£o, assim essas
> colunas s√£o preenchidas com valores nulos

Adicionalmente s√£o extra√≠das as seguintes colunas com informa√ß√µes
t√©cnicas das esta√ß√µes:

- `Pot√™ncia(W)`
- `Cod_TipoAntena`
- `Polariza√ß√£o`
- `Raio_Antena`
- `Ganho_Antena`
- `Frente_Costa_Antena`
- `Angulo_Meia_Potencia_Antena`
- `√Çngulo_Eleva√ß√£o`
- `Azimute`
- `Altura_Antena`
- `Perdas_Acessorias`

### P√≥s-Processamento üõ†Ô∏è

- S√£o mantidas somente esta√ß√µes nos estados autorizados a operar:
  `C1, C2, C3, C4, C7, C98`

- Normalizada as frequ√™ncias para a unidade `MHz`

- Imputados os valores para `Largura_de_Emiss√£o(kHz)`, e.g.¬†`256kHz`
  para o canal est√©reo de FM, `6MHz` para TV Digital etc.

  > Apesar de n√£o constar esses dados na base, os valores de refer√™ncia
  > s√£o conhecidos pela natureza do Servi√ßo.

<details>
<summary>Code</summary>

``` python
print(f'A base do MOSAICO de Radiodifus√£o possui atualmente {len(df)} registros ativos pelos filtros descritos.')
```

</details>

    A base do MOSAICO de Radiodifus√£o possui atualmente 31012 registros ativos pelos filtros descritos.

### Dados Incorretos üóëÔ∏è

> ‚òùüèΩ Os dados do MOSAICO de Radiodifus√£o s√£o bastante incompletos em
> rela√ß√£o √†s coordenadas, praticamente metade dos registros ap√≥s a
> filtragem e p√≥s-processamento n√£o possuem latitude e/ou longitude. No
> entanto esses dados n√£o s√£o exclu√≠dos deliberadamente porque nesses
> registros ser√£o imputados as coordenadas centrais do munic√≠pio no qual
> se encontram na etapa de valida√ß√£o de coordenadas.

<details>
<summary>Code</summary>

``` python
df[['Latitude', 'Longitude']] = df[['Latitude', 'Longitude']].astype('float')
bad = df[~(df.Latitude.between(MIN_LAT, MAX_LAT) & df.Longitude.between(MIN_LONG, MAX_LONG))]
print("Exemplo de coordenadas incorretas ou ausentes: ")
bad.loc[:, ['Frequ√™ncia', 'Entidade', 'Esta√ß√£o', 'Munic√≠pio', 'Latitude', 'Longitude']]
```

</details>

    Exemplo de coordenadas incorretas ou ausentes: 

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequ√™ncia</th>
      <th>Entidade</th>
      <th>Esta√ß√£o</th>
      <th>Munic√≠pio</th>
      <th>Latitude</th>
      <th>Longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>207.0</td>
      <td>REDE DE COMUNICACOES ACREANA LTDA</td>
      <td>&lt;NA&gt;</td>
      <td>Cruzeiro do Sul</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>539.0</td>
      <td>X-MEDIAGROUP S.A.</td>
      <td>&lt;NA&gt;</td>
      <td>M√¢ncio Lima</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>16</th>
      <td>593.0</td>
      <td>FUNDACAO EDUCACIONAL E CULTURAL DAS AGUAS QUENTES</td>
      <td>&lt;NA&gt;</td>
      <td>Caldas Novas</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17</th>
      <td>665.0</td>
      <td>GUARANI RADIODIFUSAO LTDA</td>
      <td>&lt;NA&gt;</td>
      <td>Caldas Novas</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24</th>
      <td>551.0</td>
      <td>OCAN COMUNICACAO DIGITAL SE LTDA</td>
      <td>1004428283</td>
      <td>Santa Quit√©ria do Maranh√£o</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>31005</th>
      <td>581.0</td>
      <td>PREFEITURA MUNICIPAL DE APIUNA</td>
      <td>&lt;NA&gt;</td>
      <td>Api√∫na</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>31006</th>
      <td>593.0</td>
      <td>PREFEITURA MUNICIPAL DE ALVINOPOLIS</td>
      <td>&lt;NA&gt;</td>
      <td>Alvin√≥polis</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>31007</th>
      <td>635.0</td>
      <td>PREFEITURA MUNICIPAL DE SAO TIAGO</td>
      <td>&lt;NA&gt;</td>
      <td>S√£o Tiago</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>31008</th>
      <td>503.0</td>
      <td>PREFEITURA MUNICIPAL DE SAO TIAGO</td>
      <td>&lt;NA&gt;</td>
      <td>S√£o Tiago</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>31009</th>
      <td>491.0</td>
      <td>PREFEITURA MUNICIPAL DE CAMPOS ALTOS</td>
      <td>&lt;NA&gt;</td>
      <td>Campos Altos</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>16005 rows √ó 6 columns</p>
</div>

## MOSAICO - Telecomunica√ß√µes

<details>
<summary>Code</summary>

``` python
df = pd.read_parquet(pasta / 'telecom.parquet.gzip')
df[['Latitude', 'Longitude']] = df[['Latitude', 'Longitude']].astype('float')
df.sample(5).iloc[:, :6]
```

</details>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequ√™ncia</th>
      <th>Entidade</th>
      <th>Fistel</th>
      <th>Esta√ß√£o</th>
      <th>Munic√≠pio</th>
      <th>C√≥digo_Munic√≠pio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>467215</th>
      <td>148.71</td>
      <td>TECON RIO GRANDE S/A</td>
      <td>50001197975</td>
      <td>1014986777</td>
      <td>Rio Grande</td>
      <td>4315602</td>
    </tr>
    <tr>
      <th>561127</th>
      <td>245.225</td>
      <td>OI S.A. - EM RECUPERA√á√ÉO JUDICIAL</td>
      <td>06030093525</td>
      <td>691968292</td>
      <td>&lt;NA&gt;</td>
      <td>2914307</td>
    </tr>
    <tr>
      <th>147545</th>
      <td>165.99375</td>
      <td>COMPANHIA ESTADUAL DE DISTRIBUICAO DE ENERGIA ...</td>
      <td>50405704062</td>
      <td>1003279950</td>
      <td></td>
      <td>4317301</td>
    </tr>
    <tr>
      <th>492247</th>
      <td>14.76</td>
      <td>CLARO S.A.</td>
      <td>50013414186</td>
      <td>692458719</td>
      <td>Jaboat√£o dos Guararapes</td>
      <td>2607901</td>
    </tr>
    <tr>
      <th>146266</th>
      <td>383.65</td>
      <td>CSP - COMPANHIA SIDERURGICA DO PECEM</td>
      <td>50413236749</td>
      <td>1003176000</td>
      <td></td>
      <td>2312403</td>
    </tr>
  </tbody>
</table>
</div>

### Filtragem ‚úÇÔ∏è

A *query* do MongoDB para a base LICENCIAMENTO √© listada e descrita a
seguir

``` python
{"DataExclusao": None},
{"DataValidade": {"$nin": ["", None]}},
{"Status.state": "LIC-LIC-01"},
{"NumServico": {"$nin": ["010", "045", "171", "450", "750", "", None]}},
{"FreqTxMHz": {"$nin": [None, "", 0]}},
{"CodMunicipio": {"$nin": [None, ""]}},
{"FreqTxMHz": {"$type": 1.0}},
{"Latitude": {"$type": 1.0}},
{"Longitude": {"$type": 1.0}}
```

- Registros cuja data de exclus√£o √© Nula, i.e.¬†registros ativos
- Data de Validade de Radiofrequ√™ncia n√£o nula ou vazia
- Estado `Licenciado`
- Excluir servi√ßos que n√£o s√£o de Radiodfus√£o ou n√£o s√£o relevantes
  pelos Planos de Monitora√ß√£o atualmente, por exemplo `010 - SMP` √©
  extra√≠do separadamente.
- Frequ√™ncia de Transmiss√£o n√£o nula, zerada ou vazia
- C√≥digo de Munic√≠pio n√£o nulo ou vazio
- Frequ√™ncia de Transmiss√£o no formato num√©rico (eliminar registros com
  caracteres e texto)
- Latitude no formato num√©rico
- Longitude no formato num√©rico

### Descri√ß√£o üìä

> A base do `MOSAICO - licenciamento`, da qual as tabelas de
> `Telecomunica√ß√µes` e `Servi√ßo M√≥vel Pessoal` s√£o extra√≠das, √© de longe
> a maior atualmente com milh√µes de registros ativos. As colunas
> extra√≠das para os servi√ßos de telecomunica√ß√µes s√£o as mesmas descritas
> anteriormente no `MOSAICO - Radiodifus√£o`.

### P√≥s-Processamento üõ†Ô∏è

> O p√≥s-processamento do MOSAICO - LICENCIAMENTO √© mais complexo por
> conta das escolhas na modelagem do Banco e faz uso extenso de fun√ß√µes
> da biblioteca `pandas`

- A string `DesignacaoEmiss√£o` √© a concatena√ß√£o das colunas
  `Largura_Emiss√£o` e `Classe_Emiss√£o` como constavam no STEL. Al√©m do
  mais existem esta√ß√µes com m√∫ltiplas strings de `Emiss√£o` na mesma
  coluna separadas por v√≠rgula, os passos de processamento dessa colunas
  s√£o os seguintes:

  - Elimina√ß√£o de espa√ßos e normaliza√ß√£o para mai√∫scula
  - Expans√£o dos m√∫ltiplos registros separados por v√≠rgula em linhas
    individuais, 1 por linha com as demais informa√ß√µes id√™nticas
  - Processamento de cada string `Emiss√£o` concatenada nas duas partes
    at√¥micas: `Largura_Emiss√£o` e `Classe_Emiss√£o`

- `Multiplicidade`: Contador do n√∫mero de esta√ß√µes similares:

  - Existem registros com todas as caracter√≠sticas anteriores id√™nticas,
    exceto o `Esta√ß√£o` por exemplo.
  - Esta√ß√µes possuem detalhes t√©cnicos que n√£o s√£o considerados
    relevantes, pelo menos no escopo atual, para a An√°lise Espectral e
    Identifica√ß√£o de Emiss√µes - como por exemplo:
    - Tipo de Antena
    - Polariza√ß√£o: Horizontal ou Vertical.
    - Altura da Antena
    - Pot√™ncia de Transmiss√£o

  A seguir √© mostrado um exemplo de esta√ß√£o desse tipo, com **201**
  esta√ß√µes com caracter√≠sticas t√©cnicas id√™nticas conforme o quesito
  descrito no par√°grafo anterior:
  ![image.png](index_files/figure-commonmark/9e226b1d-2-image.png)

  > Esses registros s√£o considerados id√™nticos e s√£o agrupados. √â
  > utilizado o primeiro n√∫mero de esta√ß√£o que aparece na base como
  > refer√™ncia e o total de esta√ß√µes ‚Äúid√™nticas‚Äù √© registrado na coluna
  > multiplicidade: *1 para esta√ß√µes ‚Äú√∫nicas‚Äù e qualquer valor maior que
  > 1 descreve o n√∫mero de esta√ß√µes similares agrupadas, como as 201 no
  > exemplo anterior*
  > ![image.png](index_files/figure-commonmark/9e226b1d-1-image-2.png)

Atualmente esse agrupamento de esta√ß√µes similares em um √∫nico registro
reduz o n√∫mero de registro para certa de 10% do original, em outras
palavras, no p√≥s-processamento s√£o agregadas cerca de 90% das esta√ß√µes.

<details>
<summary>Code</summary>

``` python
print(f'A base do MOSAICO de Telecomunica√ß√µes possui atualmente {len(df)} registros ativos pelos filtros descritos.')
```

</details>

    A base do MOSAICO de Telecomunica√ß√µes possui atualmente 757142 registros ativos pelos filtros descritos.

## MOSAICO - Servi√ßo M√≥vel Pessoal

> Como o servi√ßo de telefonia e banda larga m√≥vel √© um servi√ßo de
> extrema import√¢ncia e aspecto distinto, com diferentes necessidades de
> p√≥s-processamento. Esse servi√ßo √© extra√≠do num fluxo espec√≠fico.

<details>
<summary>Code</summary>

``` python
df = pd.read_parquet(pasta / 'smp_formated.parquet.gzip')
df2 = pd.read_parquet(pasta / 'smp_processado.parquet.gzip')
df[['Latitude', 'Longitude']] = df[['Latitude', 'Longitude']].astype('float')
df.sample(5).iloc[:, :6]
```

</details>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NumAto</th>
      <th>DataValidade</th>
      <th>NumFistel</th>
      <th>NomeEntidade</th>
      <th>NumEstacao</th>
      <th>Latitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1853288</th>
      <td>110062022.0</td>
      <td>2023-04-20</td>
      <td>50409146285</td>
      <td>TELEFONICA BRASIL S.A.</td>
      <td>1010971724</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1926821</th>
      <td>29272013</td>
      <td>2023-04-30</td>
      <td>50409314250</td>
      <td>TIM S A</td>
      <td>1015051127</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1105173</th>
      <td>125002022</td>
      <td>2028-11-29</td>
      <td>50409314250</td>
      <td>TIM S A</td>
      <td>688394825</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>616063</th>
      <td>155832022</td>
      <td>2028-11-29</td>
      <td>50409146366</td>
      <td>TELEFONICA BRASIL S.A.</td>
      <td>1000130875</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>892766</th>
      <td>46622011</td>
      <td>2028-03-31</td>
      <td>50409105090</td>
      <td>CLARO S.A.</td>
      <td>641099355</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

### Filtragem ‚úÇÔ∏è

> A query para o servi√ßo SMP, assim como o restante das bases do
> `MOSAICO` √© a mais simples poss√≠vel, uma vez que filtros e
> p√≥s-processamento mais sofisticados s√£o feitos diretamente no python
> utilizando o todo poderoso `pandas` üêº

``` python
MONGO_SMP = {
    "$and": [
        {"DataValidade": {"$nin": ["", None]}},
        {"Status.state": "LIC-LIC-01"},
        {"NumServico": "010"},
        {"FreqTxMHz": {"$nin": [None, "", 0]}},
        {"CodMunicipio": {"$nin": [None, ""]}},
        {"FreqTxMHz": {"$type": 1.0}},
    ]
}
```

- Registros cuja data de exclus√£o √© Nula, i.e.¬†registros ativos
- Estado `Licenciado`
- Extra√ß√£o de esta√ß√µes do servi√ßo SMP - `010`
- Frequ√™ncia de Transmiss√£o n√£o nula, zerada ou vazia
- C√≥digo de Munic√≠pio n√£o nulo ou vazio
- Frequ√™ncia de Transmiss√£o no formato num√©rico (eliminar registros com
  caracteres e texto)

### Descri√ß√£o üìä

> As colunas extra√≠das s√£o as mesmas j√° descritas anteriormente para as
> bases de Radiodifus√£o e Licenciamento.

### P√≥s-Processamento üõ†Ô∏è

> O p√≥s-processamento do `MOSAICO - Servi√ßo M√≥vel Pessoal` envolve mais
> passos al√©m do que j√° foi descrito para o `MOSAICO - Licenciamento`.
> As informa√ß√µes cadastradas s√£o de responsabilidade das entidades, e
> portanto n√£o h√° garantia de corretude das informa√ß√µes prestadas.
> Diversos problemas s√£o encontrados, como dados ausentes e incorretos.

- A string `DesignacaoEmiss√£o` √© processada da mesma forma descrita no
  par√°grafo anterior para a base `MOSAICO - Licenciamento`, dela √©
  derivada a coluna `Classe_Emiss√£o` e `Largura_Emiss√£o(kHz)`

- Os registros que possuem a `Frequ√™ncia_Transmiss√£o` inv√°lida mas n√£o
  nula ( lembre-se que esses casos j√° s√£o filtrados pela *query*
  efetuada direto no *MongoDB*), tem essa coluna substitu√≠da pela
  `Frequ√™ncia_Central` caso esta seja v√°lida. Isso √© feito para que um
  registro somente seja descartado quando n√£o for poss√≠vel fazer nenhum
  processamento para contornar.

- `Largura_Emiss√£o(kHz)`: Valores nulos s√£o preenchidos com o valor 0

- `Classe_Emiss√£o`: Valores nulos s√£o preenchidos com a string: `NI` (
  N√£o Informado )

- `Constru√ß√£o da Informa√ß√£o do Canal` \> Apesar da informa√ß√£o do canal
  estar cadastrada nas colunas `Frequ√™ncia Inicial`, `Frequ√™ncia Final`,
  muitos registros est√£o ausentes ou simplesmente incorretos. Portanto
  essas informa√ß√µes s√£o descartadas e o canal √© derivado √† partir da
  `Frequ√™ncia_Transmiss√£o` e `Largura_Emiss√£o(kHz)`.

  - O In√≠cio e Fim do Canal s√£o constru√≠dos da seguinte forma:
    - `In√≠cio_Canal = Frequ√™ncia_Transmiss√£o - Largura_Emiss√£o`
    - `Fim_Canal = Frequ√™ncia_Transmiss√£o + Largura_Emiss√£o`

- `Multiplicidade` ( Contagem de Esta√ß√µes com as mesmas caracter√≠sticas
  ) \> Os respons√°veis t√©cnicos pela supervis√£o dos Planos de
  Monitora√ß√£o da Anatel definiram as seguintes colunas como √≠ndices para
  agrupar esta√ß√µes:
  `['UF', 'C√≥digo_Munic√≠pio', 'Fistel', 'Frequ√™ncia_Transmiss√£o', 'Largura_Emiss√£o(kHz)', 'Classe_Emiss√£o']`
  Em outras palavras, as esta√ß√µes que possuem essas caracter√≠sticas
  iguais, s√£o essencialmente id√™nticas para os fins espec√≠ficos de
  detec√ß√£o no √¢mbito dos planos de monitora√ß√£o.

  1.  Qualquer registro com algum desses dados ainda nulos √© exclu√≠do -
      n√£o √© poss√≠vel agrupar registro que possua alguma coluna com valor
      nulo
  2.  O seguir os registros s√£o agrupados segundo as colunas
      supracitadas e a contagem de cada grupo √∫nico √© registrada na
      coluna `Multiplicidade`

- `Valida√ß√£o dos Canais`

  1.  Carregado *arquivo de canaliza√ß√£o* do servi√ßo, previamente
      constru√≠do √† partir da [Resolu√ß√£o n¬∫ 757, de 08 de novembro de
      2022](https://informacoes.anatel.gov.br/legislacao/resolucoes/2022/1760-resolucao-757)
  2.  Para cada registro da base j√° agregada a canaliza√ß√£o √© validada da
      seguinte forma:
      - O canal √© cruzado com o *arquivo de canaliza√ß√£o* e checado se o
        canal est√° contido num bloco √∫nico ou num conjunto de blocos
        adjacentes dentro de uma das faixas autorizadas. As seguintes
        informa√ß√µes adicionais s√£o inclu√≠das:
        1.  `Canaliza√ß√£o`: `V√°lido | Inv√°lido`  
        2.  `Faixa`: Faixa na qual o canal pertence
        3.  `Blocos`: Bloco ou Blocos adjacentes que cont√©m o canal
        4.  `Offset`: Anotado o `Offset` *Downlink* \<-\> *Uplink* do
            bloco ou blocos do Canal

        > O registro nesse caso √© referente ao *Downlink*, esse valor de
        > `Offset` ser√° usado para definirmos a frequ√™ncia de *Uplink*

- `Deriva√ß√£o da Frequ√™ncia de *Uplink*`

  1.  Verifica√ß√£o da consist√™ncia dos blocos de *Downlink*

  > Para cada canal validado pelo, se estiver contido em mais de um
  > bloco, os blocos devem ser adjacentes e possuir somente 1 valor de
  > `Offset`

  2.  Filtrados registros com canaliza√ß√£o `Inv√°lido`
  3.  Filtrados registros com `Offset=0` e\|ou `Largura_Emiss√£o=0`

  > Nesse caso a Frequ√™ncia de *Uplink* √© igual √† Frequ√™ncia de
  > *Downlink* e o registro vale para ambos os casos

  4.  Criada Frequ√™ncia de *Uplink*:
      `Frequ√™ncia_Uplink = Frequ√™ncia_Downlink - Offset`
  5.  Concatenado na base os registros derivados de *Uplink*

  > Nesse caso s√£o os mesmos dados dos registros v√°lidos de *Downlink*
  > mas com a frequ√™ncia ( orinalmente de *Downlink* ) substitu√≠da pela
  > frequ√™ncia derivada de *Uplink*

- `Substitui√ß√£o de Coordenadas para os registros agrupados`

  - Para os registros que possuem `Multiplicidade=1`, n√£o houve
    agrega√ß√£o e a esta√ß√£o √© √∫nica. Para esses a coordenada da esta√ß√£o √©
    mantida.

  - Para todos os demais registros as coordenadas s√£o substitu√≠das pela
    coordenada do munic√≠pio, √† partir do `C√≥digo_Munic√≠pio` presente no
    registro.

    > Outro tipo de processamento, como imputar uma m√©dia das
    > coordenadas por exemplo, n√£o agrega valor ‚Äúfiscalizat√≥rio‚Äù porque
    > gera uma coordenada que n√£o existe. A substitui√ß√£o pela coordenada
    > central do munic√≠pio tem o prop√≥sito simplesmente de dar a
    > localidade na qual aquele conjunto de esta√ß√µes pertence.

- `Formata√ß√£o Final`

  - Concatenada a informa√ß√£o sobre a `Tecnologia` na coluna
    `Classe_Emiss√£o`

  - `Status`: Inserido nessa coluna um valor √∫nico `L` para indicar que
    √© licenciada

  - `Fonte`: `MOS` ( MOSAICO ) para o *Downlink* e `DOC` para o *Uplink*

    > Esse valor `DOC` vem de Documenta√ß√£o, termo usado genericamente
    > aqui para indicar todos os registros ‚Äúcriados‚Äù e n√£o presentes
    > numa base espec√≠fica, como √© o caso aqui dos valores de *Uplink*

  - `Classe`: Inserido os valores `FB` (Fixa Base) e `ML` (M√≥vel) para
    os registros de *Downlink* e *Uplink* respectivamente

<details>
<summary>Code</summary>

``` python
print(f'A base do MOSAICO - SMP possui atualmente {len(df)} registros extra√≠dos ativos')
print(f'e {len(df2)} registros resultados processados pelos crit√©rios descritos.')
```

</details>

    A base do MOSAICO - SMP possui atualmente 1977611 registros extra√≠dos ativos
    e 293613 registros resultados processados pelos crit√©rios descritos.

## AERON√ÅUTICA üõ¨

Al√©m de prover uma API que extrai, limpa, processa e padroniza os dados
de esta√ß√µes licenciadas na Anatel - relevantes para a Identifica√ß√£o de
Emiss√µes no √¢mbito dos Planos de Monitora√ß√£o - Outro diferencial s√£o os
dados adicionais de emiss√µes aeron√°uticas extra√≠dos e consolidados
provenientes de diversas fontes, em sua maioria sem registro ‚Äúoficial‚Äù
na Anatel.

As fontes de dados aeron√°uticos s√£o:

- ICAO - Atrav√©s do Software [*Frequency
  Finder*](https://www.icao.int/safety/FSMP/Documents/Forms/AllItems.aspx?RootFolder=%2fsafety%2ffsmp%2fdocuments%2ffrequencyfinder&FolderCTID=0x012000B1461A5DA8C64241AA4DE4F91CB1D9AF%20%E2%80%8B)
  s√£o filtradas e exportadas as emiss√µes do Brasil

- [API do
  AISWEB](https://documenter.getpostman.com/view/7201070/SzKQyg3H)

  - Todos as emiss√µes de Aer√≥dromos P√∫blicos e Militares

- [API do GEOAISWEB](https://geoaisweb.decea.mil.br/)

  - Emiss√µes do tipo `VOR`, `NDB` e `DME`

- [API do
  REDEMET](https://ajuda.decea.mil.br/base-de-conhecimento/api-redemet-produtos-radar/)

  - Especificamente dados de radares meteorol√≥gicos

- Arquivo de Radares

  - Dados adicionais de Radares Secund√°rios nas frequ√™ncias `1030MHz` e
    `1090MHz` com frequ√™ncia e localiza√ß√£o conhecida, dispon√≠vel por
    documenta√ß√£o interna.

- Arquivo de Canaliza√ß√£o

  - Este arquivo, tamb√©m criado por meio de documenta√ß√£o interna, mapeia
    os canais das frequ√™ncias do tipo `VOR_ILSLoc`, nas frequ√™ncias
    adicionais `ILS glide`, `DME Airborne` e `DME Ground`.

  ![image.png](index_files/figure-commonmark/5a1f3344-1-image.png)

  > Os registros presentes nas bases da aeron√°utica, normalmente s√≥
  > cont√©m registros das frequ√™ncias `VOR_ILSLoc`, no entanto para os
  > canais listados as demais frequ√™ncias est√£o presentes e como parte
  > do p√≥s-processamento essas frequ√™ncias s√£o imputadas mantendo a
  > mesma descri√ß√£o e localiza√ß√£o.

### P√≥s-Processamento

N√£o cabe descrever aqui como √© implementado o c√≥digo para consumir as
APIs, alguns s√£o um tanto complexos como o AISWEB, para tal basta
consultar a documenta√ß√£o ou investigar diretamente os m√≥dulos python no
entanto o processamento resultante √© simples de descrever:

- Mapeamento das frequ√™ncias `VOR_ILSLoc` no arquivo de canais. As
  frequ√™ncias adicionais presentes nos canais s√£o adicionadas no arquivo
  final.
- Como existe sobreposi√ß√£o de registros, i.e.¬†as bases n√£o s√£o
  individualizadas, os registros s√£o mapeados entre si e caso estejam a
  uma dist√¢ncia menor que uma dist√¢ncia de refer√™ncia ( normalmente uma
  margem bem ampla de `10Km` ou `20Km`) os registros s√£o mesclados,
  mantendo-se a coordenada do registro original do `icao` e a descri√ß√£o
  de ambos √© concatenada.

<details>
<summary>Code</summary>

``` python
df = pd.read_parquet(pasta / 'aero.parquet.gzip')
for c in ['Latitude', 'Longitude']:
    df[c] = df[c].astype('float')
df.sample(5).iloc[:, :6]
```

</details>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequency</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2874</th>
      <td>2800.0</td>
      <td>-22.464277</td>
      <td>-43.297478</td>
      <td>[RMET] Radar - Pico do Couto/RJ</td>
    </tr>
    <tr>
      <th>589</th>
      <td>1164.0</td>
      <td>-9.516666</td>
      <td>-35.783333</td>
      <td>[DOC] VOR/DME, MACEIO (Ground-based DME)</td>
    </tr>
    <tr>
      <th>533</th>
      <td>115.8</td>
      <td>-21.984562</td>
      <td>-47.344501</td>
      <td>[AISG] VOR - PIRASSUNUNGA CH 105X</td>
    </tr>
    <tr>
      <th>2375</th>
      <td>131.6</td>
      <td>-19.373888</td>
      <td>-43.582779</td>
      <td>[ICAO] AOC U 100/100, CONFINS</td>
    </tr>
    <tr>
      <th>842</th>
      <td>119.65</td>
      <td>-19.373888</td>
      <td>-43.582779</td>
      <td>[ICAO] APP-U C-150/450, CONFINS</td>
    </tr>
  </tbody>
</table>
</div>

## Valida√ß√£o de Coordenadas ‚úÖ

<details>
<summary>Code</summary>

``` python
df = pd.read_parquet(pasta / 'base.parquet.gzip')
for c in ['Latitude', 'Longitude']:
    df[c] = df[c].astype('float')
df.sample(5).iloc[:, :6]
```

</details>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequ√™ncia</th>
      <th>Entidade</th>
      <th>Fistel</th>
      <th>Esta√ß√£o</th>
      <th>Munic√≠pio</th>
      <th>C√≥digo_Munic√≠pio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>176758</th>
      <td>166.45625</td>
      <td>CONCESSIONARIA BR-040 S.A.</td>
      <td>50411716298</td>
      <td>1000516528</td>
      <td></td>
      <td>3146107</td>
    </tr>
    <tr>
      <th>788342</th>
      <td>458.025</td>
      <td>EMPRESA BRASILEIRA DE INFRA-ESTRUTURA AEROPORT...</td>
      <td>11030016470</td>
      <td>684830337</td>
      <td></td>
      <td>1100205</td>
    </tr>
    <tr>
      <th>92400</th>
      <td>157.45625</td>
      <td>AMAZONAS DISTRIBUIDORA DE ENERGIA S/A</td>
      <td>50403650801</td>
      <td>1002539185</td>
      <td></td>
      <td>1302603</td>
    </tr>
    <tr>
      <th>477613</th>
      <td>407.1</td>
      <td>Oi S.a. - em Recuperacao Judicial</td>
      <td>04030120318</td>
      <td>327632062</td>
      <td>&lt;NA&gt;</td>
      <td>3127354</td>
    </tr>
    <tr>
      <th>739091</th>
      <td>149.33</td>
      <td>PREFEITURA DO MUNICIPIO DE VALINHOS</td>
      <td>50012992097</td>
      <td>683172255</td>
      <td></td>
      <td>3556206</td>
    </tr>
  </tbody>
</table>
</div>

Vimos superficialmente nos par√°grafos anteriores que al√©m haver muitos
registros sem coordenadas - como no MOSAICO - SRD - muitas coordenadas
n√£o s√£o v√°lidas, seja por invers√£o de sinal, lugar incorreto do divisor
decimal, invers√£o da Latitude com a Longitude ou simplesmente n√£o
correspondem ao munic√≠pio no qual est√£o licenciadas.

Os passos para validar as informa√ß√µes de localiza√ß√£o s√£o:

- Os arquivos descritos anteriormente s√£o concatenados, exceto os dados
  da aeron√°utica por n√£o conter o `C√≥digo_Munic√≠pio`
- Os registros com `C√≥digo_Munic√≠pio` ausentes s√£o exclu√≠dos - este dado
  √© necess√°rio para validar se a coordenadas est√£o contidas corretamente
  no munic√≠pio.
- As dados de localiza√ß√£o - a saber `C√≥digo_Munic√≠pio`, `Latitude`,
  `Longitude` - s√£o repassados para uma *query* SQL que busca na base
  `CORPORATIVO.dbo.TB_IBGE_MUNICIPIO` e checa **se as coordenadas est√£o
  contidas no pol√≠gono caracter√≠stico descrito pelo
  `C√≥digo_Munic√≠pio`**, retornando `Verdadeiro` caso positivo e `Falso`
  caso contr√°rio:

``` sql
    SELECT 
        mun.NO_MUNICIPIO 
        , mun.NU_LONGITUDE 
        , mun.NU_LATITUDE         
        , CONVERT(int, 
            (mun.GE_POLIGONO.STIntersects(geometry::STGeomFromText(
                'POINT({} {})', 
                mun.GE_POLIGONO.STSrid)
            )) 
        )AS COORD_VALIDA
    FROM 
        CORPORATIVO.dbo.TB_IBGE_MUNICIPIO mun
    WHERE
        MUN.CO_MUNICIPIO = {}
```

- Al√©m disso √© retornado o nome padronizado do `Munic√≠pio` e suas
  coordenadas como registrado oficialmente no IBGE

## Arquivo FinalüóÑÔ∏è

O Arquivo final disponibilizado para as atividades de monitora√ß√£o √©
formatado da seguinte forma:

- Arquivo base com os dados da Anatel com as seguintes colunas:
  - `Frequ√™ncia`
  - `N√∫mero_Servi√ßo`
  - `Esta√ß√£o`
  - `Classe_Emiss√£o`
  - `Largura_Emiss√£o(kHz)`
- Para simplifica√ß√£o de como os dados s√£o apresentados, √© criada a
  coluna `Descri√ß√£o` com as seguintes colunas aglutinadas:
  - `Fonte` - *Qual das bases acima √© origin√°rio o registro*

  - `Status`

  - `Classe`

  - `Entidade`

  - `Fistel`

  - `#Esta√ß√£o` - `Esta√ß√£o`+ `Multiplicidade`

  - `Munic√≠pio_IBGE`

  - `UF`  
    A coluna `Munic√≠pio` √© substitu√≠da pela coluna `Munic√≠pio_IBGE`, por
    esta estar completa e validada atrav√©s do `C√≥digo_Munic√≠pio`

  - Os registros que n√£o possuem coordenadas ou estas foram considerados
    inv√°lidas t√™m suas coordenadas substitu√≠das pela coordenada do
    munic√≠pio.

    > Para esses registros, √© inserido o sinal `*` ao final da
    > `Descri√ß√£o`.
- Arquivo p√≥s-processado com os dados aeron√°uticos
- Mesclagem dos dados aeron√°uticos com os registros da Anatel, nos
  mesmos moldes que os dados aeron√°uticos foram mesclados entre si.
  Nesse caso os dados da Anatel s√£o mantidos e a Descri√ß√£o da esta√ß√£o
  aeron√°utica concatenada com a Descri√ß√£o da esta√ß√£o da Anatel.
- Adi√ß√£o de uma coluna num√©rica identificadora da emiss√£o:
  `#1, #2, #3, ...`

<details>
<summary>Code</summary>

``` python
df = pd.read_parquet(pasta / 'AnatelDB.parquet.gzip')
for c in ['Latitude', 'Longitude']:
    df[c] = df[c].astype('float')
df.sample(5)
```

</details>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Id</th>
      <th>Frequency</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Description</th>
      <th>Service</th>
      <th>Station</th>
      <th>Class</th>
      <th>BW</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>237679</th>
      <td>#237680</td>
      <td>167.81875</td>
      <td>-19.867044</td>
      <td>-43.925735</td>
      <td>[MOS] L, FX, Policia Militar Do Estado De Mina...</td>
      <td>19</td>
      <td>1001757839</td>
      <td>F1E</td>
      <td>8.1</td>
    </tr>
    <tr>
      <th>293084</th>
      <td>#293085</td>
      <td>168.18125</td>
      <td>-28.566111</td>
      <td>-48.792500</td>
      <td>[MOS] L, FB, Fundo De Melhoria Do Corpo De Bom...</td>
      <td>19</td>
      <td>1012937884</td>
      <td>F1D</td>
      <td>7.6</td>
    </tr>
    <tr>
      <th>102419</th>
      <td>#102420</td>
      <td>156.75000</td>
      <td>-22.873041</td>
      <td>-43.110451</td>
      <td>[STEL] L, FP, Pilot Boat Transportes Maritimos...</td>
      <td>604</td>
      <td>1007270346</td>
      <td>F3E</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>385774</th>
      <td>#385775</td>
      <td>245.47500</td>
      <td>-4.163056</td>
      <td>-42.013611</td>
      <td>[MOS] L, FX, Telemar Norte Leste S.A. Em Recup...</td>
      <td>175</td>
      <td>691448892</td>
      <td>F3E</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>30865</th>
      <td>#30866</td>
      <td>87.90000</td>
      <td>-9.851666</td>
      <td>-57.824165</td>
      <td>[SRD] RADCOM, 1-A, Associa√ß√£o Comunit√°ria De N...</td>
      <td>231</td>
      <td>1015224919</td>
      <td>NI</td>
      <td>256.0</td>
    </tr>
  </tbody>
</table>
</div>
